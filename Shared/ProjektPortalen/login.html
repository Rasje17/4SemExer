<!DOCTYPE html>
<html>

<head>
    <title>ProjektPortalen</title>
    <link rel="stylesheet" href="styles.css">
    <script>
        function loginHandle(JSONdata) {
            let data = JSON.parse(JSONdata);
            let pw = document.getElementById("pwField").value;
            let loginID = 0;
            console.log("We ARE HERE!!!");
            if (data.password == pw.toString()) {
                console.log("Password was correct!");
                // login godkendt, giv id og send videre
                if (data.busBool) {
                    // business sendes til businesspage
                    loginID = 2;
                    window.location.href = 'businessPage.html?loginVal=' + loginID;
                }
                else {
                    // student sendes til offer overview
                    loginID = 1;
                    window.location.href = 'offerOverview.html?loginVal=' + loginID;
                }
            }
            else {
                // login afvist, reset
                // evt check noget ud med et label og set style.visibility="visible", men "hidden" til at starte med
                window.location.href = 'login.html';
            }
        }
        window.onload = () => {
            let loginBtn = document.getElementById("loginButton");            
            loginBtn.addEventListener("click", () => {
                let userName = document.getElementById("uNameField").value;
                fetch("http://localhost:8888/users/" + userName)
                    .then(response => response.json())
                    .then(json => loginHandle(json));
            });
            document.getElementById("createNewButton").onclick = function() {
            location.href = 'createUser.html';
        };
        }
    </script>
</head>

<header>
    <a href="#home">Forside</a>
    <a href="#news">Nyheder</a>
    <a href="#contact">Kontakt</a>
</header>

<body>
    <h1>Login</h1>

    <div>
        
        <form>
            Brugernavn: <input class="loginBox" id="uNameField" type="text" name="username"><br>
            Password: <input class="loginBox" id="pwField" type="password" name="pw"><br>
            <input class="loginBox" id="loginButton" type="submit" value="Log ind">
            <input class="loginBox" id="createNewButton" type="button" value="Opret nyt login">
        </form>
    </div>
</body>

</html>